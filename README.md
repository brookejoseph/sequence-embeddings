#### **Description**
This Python script simulates multiple sequence alignments (MSAs) from an input protein sequence, introduces mutations, and generates embeddings using a Transformer-based model. It's designed for basic exploration of protein sequence processing and embedding generation.

---

#### **Features**
1. **Simulate MSAs**: 
   - Creates multiple mutated versions of an input sequence with configurable mutation, insertion, and deletion rates.
2. **Tensor Conversion**:
   - Converts protein sequences into a tensor format for model input.
3. **Transformer-Based Embedding**:
   - Encodes the MSA using a Transformer model to produce sequence embeddings.

---

#### **Requirements**
- Python 3.8 or higher
- PyTorch
- Install additional dependencies if required:
  ```bash
  pip install torch
  ```

---

#### **Usage**
1. **Run the Script**:
   ```bash
   python msa_embedding.py <protein_sequence>
   ```
   Example:
   ```bash
   python msa_embedding.py "ACDEFGHIKLMNPQRSTVWY"
   ```

2. **Arguments**:
   - `protein_sequence`: Input protein sequence using single-letter amino acid codes.

---

#### **Outputs**
- **MSA Tensor**: A tensor representation of the simulated MSA.
- **MSA Embeddings**: Encoded embeddings of the input MSA generated by the Transformer model.

---

#### **Example Workflow**
1. Input sequence: `"ACDEFGHIKLMNPQRSTVWY"`
2. Simulated MSA (example output):
   ```
   ['ACDEFGHIKLMNPQRSTVWY', 'ACGDFGHIKLMNPRSTVWY', ...]
   ```
3. Tensor format:
   ```
   Tensor([[0, 1, 2, 3, ...], [0, 2, 3, 6, ...]])
   ```
4. Generated embeddings:
   ```
   Tensor([[[...], [...], ...]])
   ```

---

#### **Customization**
- **Mutation Rates**: Adjust `mutation_rate`, `insertion_rate`, and `deletion_rate` in the `simulate_msa` function.
- **Model Parameters**: Modify `embedding_dim`, `nhead`, and `num_layers` in the `MSAEmbeddingModel`.

---

#### **Notes**
- The script was made because I wanted to check my understanding of the topic
- Outputs are random due to mutation and Transformer weights not being trained.

Feel free to tweak the parameters and experiment with different sequences!
